{% extends 'base.html.twig' %}

{% block title %}Messages{% endblock %}

{% block pageTitle %}Vos Messages avec {{ partner.firstName }}{% endblock %}

{% block body %}

{% include "flashMessages.html.twig" %}

<div class="row justify-content-center justify-content-lg-end mt-5  ">
    <div class="col-11 col-lg-9 justify-content-center conversation-message-block">
        <table class="table conversation-table">
            <tr>
                <th>
                    <div class="conversation-img-cadre">
                        {% if partner.image %}
                            <img class="partner-image" src="{{ asset('upload/users/' ~ partner.image) }}" alt="Photo de profile">
                        {% else %}
                            <img class="partner-image" src="{{ asset('upload/default.png') }}" alt="Photo de profile">
                        {% endif %}
                    </div>
                    <h6 class="partner">{{partner.username}}</h6>
                </th>
                <th>
                    <div class="conversation-img-cadre">
                        {% if app.user.image %}
                            <img class="current-user-image" src="{{ asset('upload/users/' ~ app.user.image) }}" alt="Photo de profile">
                        {% else %}
                            <img class="current-user-image" src="{{ asset('upload/default.png') }}" alt="Photo de profile">
                        {% endif %}
                    </div>
                    <h6 class="currentuser">
                        {{ app.user.username }}
                    </h6>
                </th>
            </tr>
            <tr>
                <td class="new-message-form-block">
                    {{ form_start(form) }}
                        {{form_row(form.body, {'attr' : { 'placeholder' : 'Nouveau message', 'autofocus': true }})}}
                        <input class="new-message-button" type="submit" value="Envoyer">
                    {{ form_end(form) }}
                </td>
            </tr>
            {% for message in messages %}
                <tr>
                    <td class="single-message {% if message.fromUser.id is same as(app.user.id) %}currentuser{% else %}partner{% endif %}">
                        <span class="date">{{ message.sendDate|ago }}</span>
                        <p class="body">{{ message.body }}</p>
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>
</div>
{% endblock %}