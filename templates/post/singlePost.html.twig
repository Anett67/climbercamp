{% extends 'base.html.twig' %}

{% block title %}Publications{% endblock %}

{% block pageTitle %}

{% endblock %}

{% block body %}

    {% include 'topLinks.html.twig' %}    

    {% include 'flashMessages.html.twig' %}

    <div class="row justify-content-center justify-content-lg-end mb-3">
        <div class="post-block col-12 col-lg-9 mt-3 p-5 ">
            <div class="row postedByAt-block align-items-center">
                <div class="col-8 col-lg-6">
                    <!-- Le bloc qui affiche le nom et la photo de l'auteur -->
                    <div class="row align-items-center">
                        <div class="img-cadre">
                            {% if post.postedBy.image %}
                                <img class="postedByProfil img-fluid" src="{{ asset('upload/users/' ~ post.postedBy.image) }}" alt="Photo de profile">
                            {% else %}
                                <img class="postedByProfil img-fluid" src="{{ asset('upload/default.png') }}" alt="Photo de profile">
                            {% endif %}
                        </div>
                        <div class="col-7 col-md-8 col-lg-9">
                            <a class="postedByName" href="{{ path('single-user',{'id' : post.postedBy.id}) }}">{{ post.postedBy.firstName }} {{ post.postedBy.lastName }}</a>
                        </div>
                    </div>
                </div>
                <!-- Le bloc qui affiche le temps passé depuis la publication -->
                <div class="col-4 col-lg-6 text-right">
                    {{ post.createdAt|ago }}
                </div>
            </div>
            <div class="row content-block">
                <!-- On vérifie si la publication a une photo ou pas et on affiche l'image si oui -->
                {% if post.image %}
                    <div class="col-12 col-lg-6">
                        <img class="postImage" src="{{ asset('upload/posts/' ~ post.image) }}" alt="">
                    </div>
                {% endif %}
                <div class="col-12 {% if post.image %}col-lg-6{% endif %} ">
                    <!-- Texte de la publication -->
                    <div class="row">
                        <p class="postBody">{{ post.body }}</p>
                    </div>
                    <div class="row justify-content-end align-items-end">
                        <!-- Bouton j'aime -->
                        <div class="col-12 {% if post.image %}col-md-6{% else %}col-md-6 col-lg-3 {% endif %}  m-2 mt-lg-5">
                            <a id="{{ post.id }}" class="btn like-button" href="{{ path('post-like', {'id': post.id}) }}">
                                <span class="js-postLikes-label{{post.id}} {% if post.isLikedByUser(app.user) %}liked{% endif %}">
                                    {% if post.isLikedByUser(app.user) %}
                                        Je n'aime plus
                                    {% else %}
                                        J'aime
                                    {% endif %}
                                </span>
                            </a>
                        </div>
                    </div>
                </div>  
            </div>
            <!-- Nombre de j'aime -->
            <div class="commentsLikes-block row mb-5">
                <div class="col-5 col-md-3 col-lg-2 m-1">
                    <a class="likes-link" href="{{ path('post-likes', {'id': post.id}) }}">
                        <span id="count{{post.id}}" class="js-postLikes">{{ post.postLikes|length }}</span>
                        J'aime
                    </a>
                </div>
            </div>
            
            {% include 'commentSection.html.twig' %}

        </div>
    </div> 

{% endblock %}